<%= link_to({ **permitted_params, sort: { field: key, direction: key == params.dig(:sort, :field) ? (params.dig(:sort, :direction) == 'asc' ? 'desc' : 'asc') : 'asc'} }) do %>
  <%= key.to_s.titleize %>
  <% if params.dig(:sort, :field) == key %>
    <%= render 'shared/table/sort_indicator', direction: params.dig(:sort, :direction) %>
  <% end %>
<% end %>
